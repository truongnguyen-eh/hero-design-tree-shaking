import { DefaultTheme } from 'styled-components';
import { ProgressIntent, ProgressThemeIntent } from './types';
import { Palette, SystemPalette } from '../../theme/global/colors';
import { camelize } from '../../fp/function';

const isProgressThemeIntent = (
  intent: ProgressIntent
): intent is ProgressThemeIntent =>
  ['primary', 'success', 'warning', 'danger', 'error', 'archived'].includes(
    intent
  );

export const getColorFromProgressIntent = ({
  theme,
  intent,
  getter,
  fallbackColor,
}: {
  theme: DefaultTheme;
  intent: ProgressIntent;
  getter: (themeIntent: ProgressThemeIntent) => string;
  fallbackColor?: string;
}) =>
  isProgressThemeIntent(intent)
    ? getter(intent)
    : fallbackColor ||
      theme.colors.palette[camelize(intent) as keyof Palette] ||
      theme.colors[camelize(intent) as keyof SystemPalette];
